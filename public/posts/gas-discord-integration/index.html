<!DOCTYPE html>
<html
  class=""
  lang="ja"
  prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"
>
  <head>
    <meta charset="utf-8" />

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="description" content="" />
<meta name="HandheldFriendly" content="True" />
<meta name="MobileOptimized" content="320" />
<meta name="viewport" content="width=device-width, initial-scale=1" />


<meta name="keywords" content="">


<meta property="og:type" content="article" />
<meta property="og:description" content="" />
<meta property="og:title" content="ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’æ›´æ–°ã™ã‚‹ã¨è‡ªå‹•ã§Discordã«é€šçŸ¥ãŒé£›ã¶ä»•çµ„ã¿" />
<meta property="og:site_name" content="talebuã®Webã‚µã‚¤ãƒˆ" />
<meta property="og:image" content="" />
<meta property="og:image:type" content="image/jpeg" />
<meta property="og:image:width" content="" />
<meta property="og:image:height" content="" />
<meta property="og:url" content="talebu.github.io/posts/gas-discord-integration/" />
<meta property="og:locale" content="ja" />
<meta property="article:published_time" content="2023-05-01
" /> <meta property="article:modified_time" content="2023-05-01
" />




<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@talebujp" />
<meta name="twitter:creator" content="@talebujp" />
<meta
  name="twitter:title"
  content="ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’æ›´æ–°ã™ã‚‹ã¨è‡ªå‹•ã§Discordã«é€šçŸ¥ãŒé£›ã¶ä»•çµ„ã¿ | talebuã®Webã‚µã‚¤ãƒˆ"
/>
<meta
  name="twitter:description"
  content="Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã§æ›´æ–°ã‚’è¡Œã†ã¨Discordã®ãƒãƒ£ãƒ³ãƒãƒ«ã«é€šçŸ¥ãŒé£›ã¶ä»•çµ„ã¿ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚
ã“ã®ä¾‹ã§ã¯ã€Cåˆ—ã«ã€Œç›¸è«‡ä¸­ã€ã¾ãŸã¯ã€Œå›ç­”æ¸ˆã€ã¨å…¥åŠ›ã™ã‚‹ã“ã¨ãŒé€šçŸ¥ã‚’é£›ã°ã™æ¡ä»¶ã§ã™ã€‚
æ¡ä»¶ã®éƒ¨åˆ†ã¯é©å®œå¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
1. æ›´æ–°é€šçŸ¥ã‚’é£›ã°ã—ãŸã„Discordã®ã‚µãƒ¼ãƒã§Webhookã‚’ä½œæˆ ã“ã¡ã‚‰ã‚’å‚è€ƒã«ã€‚
2. æ›´æ–°ã‚’è¡Œã†ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®GASã§ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã¦ä¿å­˜ function onCellValueChange(e) { const url = &#39;https://docs.google.com/spreadsheets/YOUR-SPREADSHEETSURL&#39;; // æ¡ä»¶ if (e.range.getColumn() === 3) { if (e.value === &#34;ç›¸è«‡ä¸­&#34;) { postMessageToDiscord(`ğŸ¾ ç›¸è«‡ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚\n ${url}`); } else if (e.value === &#34;å›ç­”æ¸ˆ&#34;) { postMessageToDiscord(`ğŸ‰ å›ç­”ã‚’å…¥åŠ›ã—ã¾ã—ãŸã€‚\n ${url}`); } } } function postMessageToDiscord(message) { // WebhookURLã‚’è¨­å®šã™ã‚‹ const discordUrl = &#39;https://discord.com/api/webhooks/YOUR-DISCORD-SERVER_WEBHOOK-URL&#39;; const payload = JSON.stringify({content: message}); const params = { headers: { &#39;Content-Type&#39;: &#39;application/json&#39; }, method: &#34;POST&#34;, payload: payload, muteHttpExceptions: true }; const response = UrlFetchApp.|"
/>
<meta name="twitter:image:src" content="" />
<meta name="twitter:domain" content="talebu.github.io/posts/gas-discord-integration/" />



    <title>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’æ›´æ–°ã™ã‚‹ã¨è‡ªå‹•ã§Discordã«é€šçŸ¥ãŒé£›ã¶ä»•çµ„ã¿</title>
    <link rel="canonical" href="talebu.github.io/posts/gas-discord-integration/" />


    <link
  rel="stylesheet"
  href="https://unpkg.com/tachyons@4.11.1/css/tachyons.min.css"
/>

<link rel="stylesheet" href="talebu.github.iocss/style.css" />

<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/highlightjs@9.12.0/styles/github-gist.css"
/>


<script type="application/javascript">
var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
var doNotTrack = (dnt == "1" || dnt == "yes");
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	if (window.sessionStorage) {
		var GA_SESSION_STORAGE_KEY = 'ga:clientId';
		ga('create', 'G-SKQ9FJBTWW', {
	    'storage': 'none',
	    'clientId': sessionStorage.getItem(GA_SESSION_STORAGE_KEY)
	   });
	   ga(function(tracker) {
	    sessionStorage.setItem(GA_SESSION_STORAGE_KEY, tracker.get('clientId'));
	   });
   }
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


    <link rel="shortcut icon" href="/favicon-32x32.png?v=2" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  </head>


<body
  lang="ja"
  class="sans-serif w-90 w-60-ns center center-ns mv2 mv5-ns"
  itemscope
  itemtype="http://schema.org/Article"
>
  
  <a
    href="talebu.github.io"
    class="b bb bw1 pb1 no-underline black"
    >talebuã®Webã‚µã‚¤ãƒˆ</a
  >

  <section id="main" class="mt5">
    <h1 itemprop="name" id="title">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’æ›´æ–°ã™ã‚‹ã¨è‡ªå‹•ã§Discordã«é€šçŸ¥ãŒé£›ã¶ä»•çµ„ã¿</h1>

    <article itemprop="articleBody" id="content" class="w-90 lh-copy">
      <p>Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã§æ›´æ–°ã‚’è¡Œã†ã¨Discordã®ãƒãƒ£ãƒ³ãƒãƒ«ã«é€šçŸ¥ãŒé£›ã¶ä»•çµ„ã¿ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚</p>
<p>ã“ã®ä¾‹ã§ã¯ã€Cåˆ—ã«ã€Œç›¸è«‡ä¸­ã€ã¾ãŸã¯ã€Œå›ç­”æ¸ˆã€ã¨å…¥åŠ›ã™ã‚‹ã“ã¨ãŒé€šçŸ¥ã‚’é£›ã°ã™æ¡ä»¶ã§ã™ã€‚</p>
<p>æ¡ä»¶ã®éƒ¨åˆ†ã¯é©å®œå¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
<h3 id="1-æ›´æ–°é€šçŸ¥ã‚’é£›ã°ã—ãŸã„discordã®ã‚µãƒ¼ãƒã§webhookã‚’ä½œæˆ">1. æ›´æ–°é€šçŸ¥ã‚’é£›ã°ã—ãŸã„Discordã®ã‚µãƒ¼ãƒã§Webhookã‚’ä½œæˆ</h3>
<p><a href="https://support.discord.com/hc/en-us/articles/228383668-Intro-to-Webhooks">ã“ã¡ã‚‰</a>ã‚’å‚è€ƒã«ã€‚</p>
<h3 id="2-æ›´æ–°ã‚’è¡Œã†ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®gasã§ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã¦ä¿å­˜">2. æ›´æ–°ã‚’è¡Œã†ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®GASã§ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã¦ä¿å­˜</h3>
<pre tabindex="0"><code>function onCellValueChange(e) {
  const url = &#39;https://docs.google.com/spreadsheets/YOUR-SPREADSHEETSURL&#39;;
  // æ¡ä»¶
  if (e.range.getColumn() === 3) {
    if (e.value === &#34;ç›¸è«‡ä¸­&#34;) {
      postMessageToDiscord(`ğŸ¾ ç›¸è«‡ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚\n ${url}`);
    } else if (e.value === &#34;å›ç­”æ¸ˆ&#34;) {
      postMessageToDiscord(`ğŸ‰ å›ç­”ã‚’å…¥åŠ›ã—ã¾ã—ãŸã€‚\n ${url}`);
    }
  }
}

function postMessageToDiscord(message) {

  // WebhookURLã‚’è¨­å®šã™ã‚‹
  const discordUrl = &#39;https://discord.com/api/webhooks/YOUR-DISCORD-SERVER_WEBHOOK-URL&#39;;
  const payload = JSON.stringify({content: message});
  const params = {
    headers: {
      &#39;Content-Type&#39;: &#39;application/json&#39;
    },
    method: &#34;POST&#34;,
    payload: payload,
    muteHttpExceptions: true
  };

  const response = UrlFetchApp.fetch(discordUrl, params);
  Logger.log(response.getContentText());

}
</code></pre><h3 id="3-cåˆ—ã«ç›¸è«‡ä¸­å›ç­”æ¸ˆã¨å…¥åŠ›ã™ã‚‹">3. Cåˆ—ã«ã€Œç›¸è«‡ä¸­ã€ã€Œå›ç­”æ¸ˆã€ã¨å…¥åŠ›ã™ã‚‹</h3>
<p>Discordã«é€šçŸ¥ãŒé£›ã³ã¾ã™ã€‚</p>

    </article>
  </section>

  <footer>
  <div>
    <p class="f6 gray mt6 lh-copy">
      Â© 2023 <a href='https://twitter.com/talebujp' target='_blank'>@talebujp</a>.
    </p>
  </div>
</footer>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/highlight.min.js"></script>

<script>
  hljs.initHighlightingOnLoad();
</script>



  </body>
</html>
